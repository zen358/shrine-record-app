<%# 参拝記録フォーム（新規作成・編集共通） %>
<%= form_with model: shrine_record, local: true do |f| %>

  <%# 神社名（必須） %>
  <div class="mb-3">
    <%= f.label :shrine_name, "神社名", class: "form-label" %>
    <span class="badge bg-danger">必須</span>
    <%= f.text_field :shrine_name, class: "form-control", placeholder: "例：伊勢神宮" %>
  </div>

  <%# 御祭神 %>
  <div class="mb-3">
    <%= f.label :deity, "御祭神", class: "form-label" %>
    <%= f.text_field :deity, class: "form-control", placeholder: "例：天照大御神" %>
  </div>

  <%# 御利益 %>
  <div class="mb-3">
    <%= f.label :benefit, "御利益", class: "form-label" %>
    <%= f.text_field :benefit, class: "form-control", placeholder: "例：商売繁盛、縁結び" %>
  </div>

  <%# 参拝日（必須） %>
  <div class="mb-3">
    <%= f.label :visited_on, "参拝日", class: "form-label" %>
    <span class="badge bg-danger">必須</span>
    <%= f.date_field :visited_on, class: "form-control", value: shrine_record.visited_on || Date.today %>
  </div>

  <%# お願いごと %>
  <div class="mb-3">
    <%= f.label :wish, "お願いごと", class: "form-label" %>
    <%= f.text_area :wish, class: "form-control", rows: 3, placeholder: "参拝時にお願いしたこと" %>
  </div>

  <%# メモ %>
  <div class="mb-3">
    <%= f.label :memo, "メモ", class: "form-label" %>
    <%= f.text_area :memo, class: "form-control", rows: 3, placeholder: "自由にメモを記入" %>
  </div>

  <%# 写真アップロード %>
  <div class="mb-3">
    <%= f.label :photo, "写真", class: "form-label" %>
    <%= f.file_field :photo, class: "form-control", accept: "image/*" %>
    <div class="form-text">JPEG、PNG形式の画像をアップロードできます</div>

    <%# 既存の画像があれば表示（編集時） %>
    <% if shrine_record.photo.attached? %>
      <div class="mt-2">
        <p class="text-muted small mb-1">現在の画像:</p>
        <%= image_tag shrine_record.photo, class: "img-thumbnail", style: "max-height: 150px;" %>
      </div>
    <% end %>
  </div>

  <%# 位置情報（緯度・経度） %>
  <div class="mb-3">
    <label class="form-label">位置情報</label>
    <div class="row">
      <%# 緯度入力欄 %>
      <div class="col-md-6">
        <%= f.label :latitude, "緯度", class: "form-label small text-muted" %>
        <%= f.number_field :latitude, class: "form-control", placeholder: "例：35.6762", step: "any" %>
      </div>
      <%# 経度入力欄 %>
      <div class="col-md-6">
        <%= f.label :longitude, "経度", class: "form-label small text-muted" %>
        <%= f.number_field :longitude, class: "form-control", placeholder: "例：139.6503", step: "any" %>
      </div>
    </div>
    <div class="form-text">Google Mapsなどで確認した緯度・経度を入力できます</div>
  </div>

  <hr class="my-4">

  <%# ボタン %>
  <div class="d-flex gap-2">
    <%= f.submit shrine_record.new_record? ? "登録する" : "更新する", class: shrine_record.new_record? ? "btn btn-success" : "btn btn-warning" %>
    <%= link_to "キャンセル", shrine_records_path, class: "btn btn-outline-secondary" %>
  </div>
<% end %>